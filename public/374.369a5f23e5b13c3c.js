"use strict";(self.webpackChunktestCloud=self.webpackChunktestCloud||[]).push([[374],{6374:(w,g,a)=>{a.r(g),a.d(g,{UsuariosModule:()=>E});var d=a(9808),m=a(3333),l=a(8390),n=a(2382),o=a(7587),c=a(520),p=a(2340);let f=(()=>{class e{constructor(t){this.http=t,localStorage.getItem("token")}getUsuarios(t=1){const r=p.N.baseUrl+"usuarios?page="+t,u={headers:(new c.WM).set("x-token",localStorage.getItem("token")||""),responseType:"json"};return this.http.get(r,u)}getUsuario(t){const r=p.N.baseUrl+"usuarios/"+t,u={headers:(new c.WM).set("x-token",localStorage.getItem("token")||""),responseType:"json"};return this.http.get(r,u)}saveUsuario(t){const r=p.N.baseUrl+"usuarios",u={headers:(new c.WM).set("x-token",localStorage.getItem("token")||""),responseType:"json"};return this.http.post(r,t,u)}deleteUsuario(t){const r=p.N.baseUrl+"usuarios/"+t,u={headers:(new c.WM).set("x-token",localStorage.getItem("token")||""),responseType:"json"};return this.http.delete(r,u)}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(c.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=a(2290),T=a(1424),U=a(845);function _(e,s){if(1&e&&(o.TgZ(0,"small",16),o._uU(1),o.qZA()),2&e){const t=o.oxw();o.xp6(1),o.Oqu(t.getErrorMsg("usuario"))}}function x(e,s){if(1&e&&(o.TgZ(0,"small",16),o._uU(1),o.qZA()),2&e){const t=o.oxw();o.xp6(1),o.Oqu(t.getErrorMsg("nombre"))}}function b(e,s){if(1&e&&(o.TgZ(0,"small",16),o._uU(1),o.qZA()),2&e){const t=o.oxw();o.xp6(1),o.Oqu(t.getErrorMsg("apellido"))}}function A(e,s){if(1&e&&(o.TgZ(0,"small",16),o._uU(1),o.qZA()),2&e){const t=o.oxw();o.xp6(1),o.Oqu(t.getErrorMsg("correo"))}}function q(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"button",17),o.NdJ("click",function(){return o.CHM(t),o.oxw().deleteUser()}),o.qZA(),o.qZA()}if(2&e){const t=o.oxw();o.xp6(1),o.Q6J("loading",t.loading)}}function C(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"button",18),o.NdJ("click",function(){return o.CHM(t),o.oxw().clearForm()}),o.qZA(),o.qZA()}if(2&e){const t=o.oxw();o.xp6(1),o.Q6J("disabled",t.loading)}}function k(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"button",19),o.NdJ("click",function(){return o.CHM(t),o.oxw().save()}),o.qZA(),o.qZA()}if(2&e){const t=o.oxw();o.xp6(1),o.Q6J("loading",t.loading)}}let h=(()=>{class e{constructor(t,r,i,u){this.router=t,this.fb=r,this.srvUsuarios=i,this.toastr=u,this.loading=!1,this.formUsuario=this.fb.group({_id:[""],usuario:["",[n.kI.required,n.kI.minLength(3)]],nombre:["",[n.kI.required,n.kI.minLength(3)]],apellido:["",[n.kI.required,n.kI.minLength(3)]],correo:["",[n.kI.required,n.kI.email]]})}get title(){return"/usuarios/form"===this.router.url?"Crear Usuario":"Detalle Usuario"}ngOnInit(){const t=parseInt(this.router.url.split("/")[3]);t&&this.getUser(t)}clearForm(){this.formUsuario.reset()}getUser(t){this.loading=!0,this.srvUsuarios.getUsuario(t).subscribe({next:r=>{this.formUsuario.patchValue(r),this.formUsuario.disable(),this.loading=!1},error:r=>{console.log(r),this.loading=!1,this.toastr.error("Error al obtener usuario"),this.router.navigate(["/usuarios/list"])},complete:()=>console.log("complete")})}save(){console.log(this.formUsuario.value),this.formUsuario.valid?(console.log("Formulario valido"),this.loading=!0,this.srvUsuarios.saveUsuario(this.formUsuario.value).subscribe({next:t=>{console.log(t),this.toastr.success("Usuario agregado correctamente"),this.router.navigate(["/usuarios/list"]),this.loading=!1},error:t=>{if(console.log(t),t.error){const{message:r,code:i}=t.error;1===i&&this.formUsuario.get("correo").setErrors({inuse:!0}),2===i&&this.formUsuario.get("usuario").setErrors({inuse:!0}),this.formUsuario.markAsTouched(),this.toastr.error(r)}else this.toastr.error("Error al agregar usuario");this.loading=!1},complete:()=>{console.log("complete")}})):(this.formUsuario.markAllAsTouched(),this.toastr.error("Errores en el formulario","Error"))}campoValido(t){return this.formUsuario.controls[t].errors&&(this.formUsuario.controls[t].dirty||this.formUsuario.controls[t].touched)}getErrorMsg(t){var r;const i=null===(r=this.formUsuario.get(t))||void 0===r?void 0:r.errors;if(i){const{required:u,minlength:Z,email:O,inuse:Y}=i;if(u)return"Campo requerido";if(Z)return"Minimo 3 caracteres";if(O)return"Email incorrecto";if(Y)return"Ya se encuentra registrado"}return""}deleteUser(){if(confirm("\xbfEsta seguro de eliminar el usuario?")){const r=this.formUsuario.get("_id").value;this.loading=!0,this.srvUsuarios.deleteUsuario(r).subscribe({next:()=>{this.toastr.success("Usuario eliminado correctamente"),this.router.navigate(["/usuarios/list"]),this.loading=!1},error:i=>{console.log(i),this.toastr.error("Error al eliminar usuario"),this.loading=!1},complete:()=>console.log("complete")})}}goback(){this.router.navigate(["/usuarios/list"])}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(m.F0),o.Y36(n.qu),o.Y36(f),o.Y36(v._W))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-form-usuarios"]],decls:32,vars:10,consts:[[1,"container"],[3,"formGroup"],[1,"formgrid","grid"],[1,"field","col-6","sm:col-12","md:col-6"],["for","usuario"],["id","usuario","type","text","pInputText","","formControlName","usuario",1,"inputfield","w-full"],["id","username2-help","class","p-error",4,"ngIf"],["for","nombre"],["id","nombre","type","text","pInputText","","formControlName","nombre",1,"inputfield","w-full"],["for","apellido"],["id","apellido","type","text","pInputText","","formControlName","apellido",1,"inputfield","w-full"],["for","correo"],["id","correo","type","text","pInputText","","formControlName","correo",1,"inputfield","w-full"],[1,"flex","justify-content-end","align-content-center"],["pButton","","type","button","label","Volver",1,"p-button-warning","mr-3",3,"disabled","click"],[4,"ngIf"],["id","username2-help",1,"p-error"],["pButton","","type","button","label","Eliminar",1,"p-button-danger",3,"loading","click"],["pButton","","type","button","label","Limpiar",1,"p-button-danger","mr-3",3,"disabled","click"],["pButton","","type","button","label","Guardar",1,"p-button-info",3,"loading","click"]],template:function(t,r){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"h1"),o._uU(2),o.qZA(),o.TgZ(3,"form",1),o.TgZ(4,"div",2),o.TgZ(5,"div",3),o.TgZ(6,"label",4),o._uU(7,"Usuario"),o.qZA(),o._UZ(8,"input",5),o.YNc(9,_,2,1,"small",6),o.qZA(),o.TgZ(10,"div",3),o.TgZ(11,"label",7),o._uU(12,"Nombre"),o.qZA(),o._UZ(13,"input",8),o.YNc(14,x,2,1,"small",6),o.qZA(),o.qZA(),o.TgZ(15,"div",2),o.TgZ(16,"div",3),o.TgZ(17,"label",9),o._uU(18,"Apellido"),o.qZA(),o._UZ(19,"input",10),o.YNc(20,b,2,1,"small",6),o.qZA(),o.TgZ(21,"div",3),o.TgZ(22,"label",11),o._uU(23,"Correo"),o.qZA(),o._UZ(24,"input",12),o.YNc(25,A,2,1,"small",6),o.qZA(),o.qZA(),o.TgZ(26,"div",13),o.TgZ(27,"div"),o.TgZ(28,"button",14),o.NdJ("click",function(){return r.goback()}),o.qZA(),o.qZA(),o.YNc(29,q,2,1,"div",15),o.YNc(30,C,2,1,"div",15),o.YNc(31,k,2,1,"div",15),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(2),o.Oqu(r.title),o.xp6(1),o.Q6J("formGroup",r.formUsuario),o.xp6(6),o.Q6J("ngIf",r.campoValido("usuario")),o.xp6(5),o.Q6J("ngIf",r.campoValido("nombre")),o.xp6(6),o.Q6J("ngIf",r.campoValido("apellido")),o.xp6(5),o.Q6J("ngIf",r.campoValido("correo")),o.xp6(3),o.Q6J("disabled",r.loading),o.xp6(1),o.Q6J("ngIf",r.formUsuario.value._id),o.xp6(1),o.Q6J("ngIf",!r.formUsuario.value._id),o.xp6(1),o.Q6J("ngIf",!r.formUsuario.value._id))},directives:[n._Y,n.JL,n.sg,n.Fj,T.o,n.JJ,n.u,d.O5,U.Hq],styles:[""]}),e})();var F=a(1087),y=a(9783);function I(e,s){1&e&&(o.TgZ(0,"tr"),o.TgZ(1,"th"),o._uU(2,"Id"),o.qZA(),o.TgZ(3,"th"),o._uU(4,"Usuario"),o.qZA(),o.TgZ(5,"th"),o._uU(6,"Nombre"),o.qZA(),o.TgZ(7,"th"),o._uU(8,"Apellido"),o.qZA(),o.TgZ(9,"th"),o._uU(10,"Correo"),o.qZA(),o.qZA())}function N(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"tr",7),o.NdJ("click",function(){const u=o.CHM(t).$implicit;return o.oxw().gotoDetail(u)}),o.TgZ(1,"td"),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._uU(6),o.qZA(),o.TgZ(7,"td"),o._uU(8),o.qZA(),o.TgZ(9,"td"),o._uU(10),o.qZA(),o.qZA()}if(2&e){const t=s.$implicit;o.xp6(2),o.Oqu(t._id),o.xp6(2),o.Oqu(t.usuario),o.xp6(2),o.Oqu(t.nombre),o.xp6(2),o.Oqu(t.apellido),o.xp6(2),o.Oqu(t.correo)}}const J=[{path:"",children:[{path:"lista",component:(()=>{class e{constructor(t,r){this.srvUsuarios=t,this.router=r,this.usuarios=[]}ngOnInit(){this.getUsuarios(1)}getUsuarios(t){this.srvUsuarios.getUsuarios(t).subscribe({next:r=>{console.log(r),this.usuarios=r.usuarios},error:r=>console.log(r),complete:()=>console.log("complete")})}gotoForm(){this.router.navigate(["/usuarios/form"])}gotoDetail(t){this.router.navigate(["/usuarios/form/"+t._id])}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(f),o.Y36(m.F0))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-list-usuarios"]],decls:10,vars:1,consts:[[1,"container"],[1,"flex","justify-content-between","align-content-center"],[1,"flex","align-items-center","justify-content-center"],["pButton","","type","button","label","Agregar",1,"p-button-info",3,"click"],["responsiveLayout","scroll",3,"value"],["pTemplate","header"],["pTemplate","body"],[1,"seleccionable",3,"click"]],template:function(t,r){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div"),o.TgZ(3,"h1"),o._uU(4,"Lista de usuarios"),o.qZA(),o.qZA(),o.TgZ(5,"div",2),o.TgZ(6,"button",3),o.NdJ("click",function(){return r.gotoForm()}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(7,"p-table",4),o.YNc(8,I,11,0,"ng-template",5),o.YNc(9,N,11,5,"ng-template",6),o.qZA(),o.qZA()),2&t&&(o.xp6(7),o.Q6J("value",r.usuarios))},directives:[U.Hq,F.iA,y.jx],styles:[".seleccionable[_ngcontent-%COMP%]{cursor:pointer}.seleccionable[_ngcontent-%COMP%]:hover{background-color:#e5f1f7}"]}),e})(),canActivate:[l.z],canLoad:[l.z]},{path:"form",component:h,canActivate:[l.z],canLoad:[l.z]},{path:"form/:id",component:h,canActivate:[l.z],canLoad:[l.z]},{path:"**",redirectTo:"lista"}]}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[m.Bz.forChild(J)],m.Bz]}),e})();var L=a(2765);let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[d.ez,M,L.W,n.UX]]}),e})()}}]);